

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>framework.Noise.Noise_Smith.noise_engine &mdash; sphinx-multimodule-docexample u&#39;0.0.1&#39; documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> sphinx-multimodule-docexample
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">sphinx-multimodule-docexample</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>framework.Noise.Noise_Smith.noise_engine</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for framework.Noise.Noise_Smith.noise_engine</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File name :</span>
<span class="sd">Authors   : </span>
<span class="sd">Email     : aarc.88@gmail.com</span>
<span class="sd">Date      : </span>
<span class="sd">Last edit :</span>
<span class="sd">Language  : Python 3.8 or &gt;</span>
<span class="sd">Aeronautical Institute of Technology - Airbus Brazil</span>

<span class="sd">Description:</span>
<span class="sd">    -</span>
<span class="sd">Inputs:</span>
<span class="sd">    -</span>
<span class="sd">Outputs:</span>
<span class="sd">    -</span>
<span class="sd">TODO&#39;s:</span>
<span class="sd">    -</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># IMPORTS</span>
<span class="c1"># =============================================================================</span>
<span class="kn">from</span> <span class="nn">framework.Attributes.Atmosphere.atmosphere_ISA_deviation</span> <span class="kn">import</span> <span class="n">atmosphere_ISA_deviation</span>
<span class="kn">from</span> <span class="nn">framework.Performance.Engine.engine_performance</span> <span class="kn">import</span> <span class="n">turbofan</span>
<span class="kn">from</span> <span class="nn">framework.Noise.Noise_Smith.atmospheric_attenuation</span> <span class="kn">import</span> <span class="n">atmospheric_attenuation</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">from</span> <span class="nn">framework.utilities.logger</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># CLASSES</span>
<span class="c1"># =============================================================================</span>

<span class="c1"># =============================================================================</span>
<span class="c1"># FUNCTIONS</span>
<span class="c1"># =============================================================================</span>
<span class="n">kt_to_ms</span> <span class="o">=</span> <span class="mf">0.514</span>
<span class="n">m_to_ft</span><span class="o">=</span> <span class="mf">3.28084</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__file__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<div class="viewcode-block" id="noise_engine"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.noise_engine">[docs]</a><span class="k">def</span> <span class="nf">noise_engine</span><span class="p">(</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">aircraft_geometry</span><span class="p">,</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">manete</span><span class="p">,</span><span class="n">N1</span><span class="p">,</span><span class="n">N2</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">vehicle</span><span class="p">):</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">vehicle</span><span class="p">[</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span>


    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">3150</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">6300</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>
    
    
    <span class="n">vairp</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="c1">## CORPO DA FUNÇÃO</span>
    <span class="c1">## Dados da atmosfera ##</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">atmosphere_ISA_deviation</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">delta_ISA</span><span class="p">)</span>   <span class="c1"># propriedades da atmosfera</span>
    <span class="n">mach</span>               <span class="o">=</span> <span class="n">vairp</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span> <span class="n">kt_to_ms</span><span class="p">)</span>                                      <span class="c1"># Numero de Mach</span>
    
    <span class="c1">## Dados do motor ##</span>
    <span class="n">thrust_force</span><span class="p">,</span> <span class="n">fuel_flow_1</span> <span class="p">,</span> <span class="n">vehicle</span> <span class="o">=</span> <span class="n">turbofan</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">manete</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span>  <span class="c1"># Atenção: N1 e N2</span>
    
    <span class="c1">## Ruído do fan e compressor ##</span>
    <span class="n">ratT</span>                <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">/</span><span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">mponto</span>              <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;fuel_flows&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nfan</span>                <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;fan_rotation&#39;</span><span class="p">]</span> 
    <span class="n">MTRd</span>                <span class="o">=</span> <span class="mf">1.3</span>
    <span class="n">nrotor</span>              <span class="o">=</span> <span class="mi">38</span>
    <span class="n">nstat</span>               <span class="o">=</span> <span class="mi">80</span>
    <span class="n">RSS</span>                 <span class="o">=</span> <span class="mi">200</span>
    <span class="n">IGV</span>                 <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ruidoFant</span>      <span class="o">=</span> <span class="n">fan</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">engine</span><span class="p">[</span><span class="s1">&#39;diameter&#39;</span><span class="p">],</span><span class="n">ratT</span><span class="p">,</span><span class="n">mponto</span><span class="p">,</span><span class="n">nfan</span><span class="p">,</span><span class="n">MTRd</span><span class="p">,</span><span class="n">nrotor</span><span class="p">,</span><span class="n">nstat</span><span class="p">,</span><span class="n">RSS</span><span class="p">,</span><span class="n">IGV</span><span class="p">)</span>
    
    
    <span class="c1">## Ruido da câmara de combustão ##</span>
    <span class="n">mdot</span>                <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;fuel_flows&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">T3K</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">T4K</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">P3</span>                  <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_pressures&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">RH</span>                  <span class="o">=</span> <span class="mi">70</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ruidocamarat</span>  <span class="o">=</span> <span class="n">combustion_chamber</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mdot</span><span class="p">,</span><span class="n">T3K</span><span class="p">,</span><span class="n">T4K</span><span class="p">,</span><span class="n">P3</span><span class="p">)</span>
    
    
    <span class="c1">## Ruido da turbina ##</span>
    <span class="n">Tturbsaida</span>           <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">nturb</span>                <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;fan_rotation&#39;</span><span class="p">]</span> 
    <span class="n">MTRturb</span>              <span class="o">=</span> <span class="mf">0.50</span>
    <span class="n">nrotor</span>               <span class="o">=</span> <span class="mi">76</span>
    <span class="n">RSSturb</span>              <span class="o">=</span> <span class="mi">50</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ruidoTurbinat</span>  <span class="o">=</span> <span class="n">turbine</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mdot</span><span class="p">,</span><span class="n">nturb</span><span class="p">,</span><span class="n">Tturbsaida</span><span class="p">,</span><span class="n">MTRturb</span><span class="p">,</span><span class="n">nrotor</span><span class="p">,</span><span class="n">RSSturb</span><span class="p">)</span>
    
    
    <span class="c1">## Ruido de Jato ##</span>
    <span class="n">ACJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;exit_areas&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ABJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;exit_areas&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">h</span>                   <span class="o">=</span> <span class="mf">0.150</span>
    <span class="n">DCJ</span>                 <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">ACJ</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">VCJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;gas_exit_speeds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">VBJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;gas_exit_speeds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">TCJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">TBJ</span>                 <span class="o">=</span> <span class="n">engine</span><span class="p">[</span><span class="s1">&#39;total_temperatures&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">roCJ</span>                <span class="o">=</span> <span class="mf">0.561</span>
    <span class="n">roBJ</span>                <span class="o">=</span> <span class="mf">1.210</span>
    <span class="n">plug</span>                <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">coaxial</span>             <span class="o">=</span> <span class="mf">1.0</span>


    <span class="c1"># (altitude,delta_ISA,noise_parameters,vairp,theta,fi,R,plug,coaxial,ACJ,ABJ,h,DCJ,VCJ,VBJ,TCJ,TBJ,roCJ,roBJ)</span>

    <span class="c1"># try:</span>
        <span class="c1"># if VCJ &gt;= 0:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ruidoJatot</span>     <span class="o">=</span> <span class="n">nozzle</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">plug</span><span class="p">,</span><span class="n">coaxial</span><span class="p">,</span><span class="n">ACJ</span><span class="p">,</span><span class="n">ABJ</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">DCJ</span><span class="p">,</span><span class="n">VCJ</span><span class="p">,</span><span class="n">VBJ</span><span class="p">,</span><span class="n">TCJ</span><span class="p">,</span><span class="n">TBJ</span><span class="p">,</span><span class="n">roCJ</span><span class="p">,</span><span class="n">roBJ</span><span class="p">)</span>
        <span class="c1"># else:</span>
            <span class="c1"># raise ValueError(&#39;VCJ is 0.&#39;)</span>
    <span class="c1"># except (ValueError, IndexError):</span>
    <span class="c1">#     log.error(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Error at &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; noise_engine&quot;, exc_info = True)</span>
    
    
    <span class="c1">## Ruido total ##</span>
    <span class="n">ruidoTotal</span>          <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">ruidoFant</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">ruidocamarat</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">ruidoTurbinat</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">ruidoJatot</span><span class="p">))</span>
    
    
    <span class="c1">## DADOS DE SAIDA ##</span>
    <span class="n">OASPLENG</span>            <span class="o">=</span> <span class="n">ruidoTotal</span>
    <span class="n">ft</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span>
    
    <span class="k">return</span> <span class="n">ft</span><span class="p">,</span> <span class="n">OASPLENG</span></div>

<div class="viewcode-block" id="fan"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.fan">[docs]</a><span class="k">def</span> <span class="nf">fan</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">engine_diameter</span><span class="p">,</span><span class="n">ratT</span><span class="p">,</span><span class="n">mponto</span><span class="p">,</span><span class="n">nfan</span><span class="p">,</span><span class="n">MTRd</span><span class="p">,</span><span class="n">nrotor</span><span class="p">,</span><span class="n">nstat</span><span class="p">,</span><span class="n">RSS</span><span class="p">,</span><span class="n">IGV</span><span class="p">):</span>
    

    <span class="n">RH</span> <span class="o">=</span> <span class="n">noise_parameters</span><span class="p">[</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">]</span>
    
    <span class="c1">## Variáveis globais</span>
    <span class="c1">#global f</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">3150</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">6300</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>

    <span class="c1">## Tabelas para interpolação</span>
    <span class="n">f1</span>                  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">44.7</span><span class="p">,</span> <span class="mf">56.2</span><span class="p">,</span> <span class="mf">70.7</span><span class="p">,</span> <span class="mf">89.1</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">282</span><span class="p">,</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">562</span><span class="p">,</span> <span class="mi">708</span><span class="p">,</span> <span class="mi">891</span><span class="p">,</span> <span class="mi">1122</span><span class="p">,</span> <span class="mi">1413</span><span class="p">,</span> <span class="mi">1778</span><span class="p">,</span> <span class="mi">2239</span><span class="p">,</span> <span class="mi">2818</span><span class="p">,</span> <span class="mi">3548</span><span class="p">,</span> <span class="mi">4467</span><span class="p">,</span> <span class="mi">5623</span><span class="p">,</span> <span class="mi">7079</span><span class="p">,</span> <span class="mi">8913</span><span class="p">])</span>
    <span class="n">f2</span>                  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">56.2</span><span class="p">,</span> <span class="mf">70.7</span><span class="p">,</span> <span class="mf">89.1</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">282</span><span class="p">,</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">562</span><span class="p">,</span> <span class="mi">708</span><span class="p">,</span> <span class="mi">891</span><span class="p">,</span> <span class="mi">1122</span><span class="p">,</span> <span class="mi">1413</span><span class="p">,</span> <span class="mi">1778</span><span class="p">,</span> <span class="mi">2239</span><span class="p">,</span> <span class="mi">2818</span><span class="p">,</span> <span class="mi">3548</span><span class="p">,</span> <span class="mi">4467</span><span class="p">,</span> <span class="mi">5623</span><span class="p">,</span> <span class="mi">7079</span><span class="p">,</span> <span class="mi">8913</span><span class="p">,</span> <span class="mi">11220</span><span class="p">])</span>
    <span class="n">F2cb</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">9.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.5</span><span class="p">])</span>
    <span class="n">tetacb</span>              <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>
    <span class="n">F3blent</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">43</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">61</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">])</span>
    <span class="n">tetablent</span>           <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>
    <span class="n">F3dsent</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.50</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.50</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.80</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">41.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">55.0</span><span class="p">])</span>
    <span class="n">tetadsent</span>           <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>
 
    <span class="n">F3bldesc</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">15.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>
    <span class="n">tetabldesc</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>
 
    <span class="n">tetadsdesc</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>
    <span class="n">F3dsdesc</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">])</span>


    <span class="c1">## CORPO DA FUNÇÃO ##</span>
    <span class="c1">## Manipulação de dados de entrada ##</span>
    <span class="n">v0</span>                  <span class="o">=</span> <span class="n">vairp</span>                                                <span class="c1"># Velocidade da aeronave [m/s]</span>
    <span class="n">radialdistance</span>      <span class="o">=</span> <span class="n">R</span>                                                    <span class="c1"># distância para avaliação do ruído [m]</span>

    <span class="c1">## Dados da atmosfera ##</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">atmosphere_ISA_deviation</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>                             <span class="c1"># propriedades da atmosfera</span>
                                        <span class="c1"># velocidade do som [m/s]</span>


    <span class="c1">## Cálculos iniciais ##</span>
    <span class="n">M0</span>                  <span class="o">=</span> <span class="n">v0</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span>                                              <span class="c1"># número de Mach da aeronave</span>
    <span class="n">MTR</span>                 <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">nfan</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">30</span><span class="o">*</span><span class="n">engine_diameter</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">delta</span>               <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">MTR</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nstat</span><span class="o">/</span><span class="n">nrotor</span><span class="p">))</span>


    <span class="c1">## Cálculo do SPL global: ##</span>
    <span class="n">deltaT</span>              <span class="o">=</span> <span class="n">ratT</span><span class="o">*</span><span class="n">T</span><span class="o">-</span><span class="n">T</span>
    <span class="n">mponto0</span>             <span class="o">=</span> <span class="mf">0.453</span>
    <span class="n">deltaT0</span>             <span class="o">=</span> <span class="mf">0.555</span>
    <span class="c1"># deltaT0             = 288.15</span>
    <span class="n">SPL</span>                 <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">deltaT</span><span class="o">/</span><span class="n">deltaT0</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mponto</span><span class="o">/</span><span class="n">mponto0</span><span class="p">)</span>


    <span class="c1">## Ruido de entrada do FAN ##</span>
    <span class="c1">## Ruído banda larga ##</span>
    <span class="n">fb</span>                  <span class="o">=</span> <span class="n">nfan</span><span class="o">*</span><span class="n">nrotor</span><span class="o">/</span><span class="mi">60</span>                                       <span class="c1"># frequencia fundamental de passagem das pás</span>
    <span class="k">if</span> <span class="n">MTRd</span><span class="o">&lt;=</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">0.9</span><span class="p">:</span>
        <span class="n">F1bent</span>          <span class="o">=</span> <span class="mf">58.5</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">0.9</span><span class="p">:</span>
        <span class="n">F1bent</span>          <span class="o">=</span> <span class="mf">58.5</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&gt;</span><span class="mf">0.9</span><span class="p">:</span>
        <span class="n">F1bent</span>          <span class="o">=</span> <span class="mf">58.5</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="o">/</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F1bent</span>          <span class="o">=</span> <span class="mf">58.5</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="o">/</span><span class="mf">0.9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">RSS</span><span class="o">&lt;=</span><span class="mi">100</span><span class="p">:</span>
        <span class="n">F2bent</span>          <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">RSS</span><span class="o">/</span><span class="mi">300</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F2bent</span>          <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">300</span><span class="p">)</span>

    <span class="n">F3bent</span>              <span class="o">=</span>     <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetablent</span><span class="p">,</span><span class="n">F3blent</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">F4bent</span>              <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="n">fb</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>  
    <span class="n">Lcbent</span>              <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1bent</span><span class="o">+</span><span class="n">F2bent</span><span class="o">+</span><span class="n">F3bent</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SPLbent</span>             <span class="o">=</span> <span class="n">Lcbent</span><span class="o">+</span><span class="n">F4bent</span><span class="o">-</span><span class="mi">10</span>
    <span class="c1">## Ruído discreto ##</span>
    <span class="c1"># Correção 01</span>
    <span class="k">if</span> <span class="n">MTRd</span><span class="o">&lt;=</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">0.72</span><span class="p">:</span>
        <span class="n">F1dent</span>          <span class="o">=</span> <span class="mf">60.5</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">0.72</span><span class="p">:</span>
        <span class="n">F1dent</span>          <span class="o">=</span> <span class="mf">60.5</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&gt;</span><span class="mf">0.72</span><span class="p">:</span>
        <span class="n">F1dent</span>          <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="mf">59.5</span><span class="o">+</span><span class="mi">80</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="o">/</span><span class="n">MTR</span><span class="p">)),(</span><span class="mf">60.5</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span><span class="o">+</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="o">/</span><span class="mf">0.72</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F1dent</span>          <span class="o">=</span> <span class="mf">60.5</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span><span class="o">+</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="o">/</span><span class="mf">0.72</span><span class="p">)</span>

    
    <span class="c1"># Correção 02</span>
    <span class="k">if</span> <span class="n">RSS</span><span class="o">&lt;=</span><span class="mi">100</span><span class="p">:</span>
        <span class="n">F2dent</span>          <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">RSS</span><span class="o">/</span><span class="mi">300</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F2dent</span>          <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="mi">300</span><span class="p">)</span>

    <span class="c1"># Correção 03</span>
    <span class="n">F3dent</span>              <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetadsent</span><span class="p">,</span><span class="n">F3dsent</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">Lcdent</span>              <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1dent</span><span class="o">+</span><span class="n">F2dent</span><span class="o">+</span><span class="n">F3dent</span>
    <span class="c1"># Correção 04</span>
    <span class="n">k</span>                   <span class="o">=</span> <span class="n">achatom</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span>
    <span class="k">if</span>  <span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">F4dent</span>          <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&gt;</span><span class="mf">1.05</span> <span class="ow">and</span> <span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&lt;=</span><span class="mf">1.05</span> <span class="ow">and</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&lt;=</span><span class="mf">1.05</span> <span class="ow">and</span> <span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> 
                                                                                <span class="c1"># para k=1 e delta&gt;1.05, não há valor, e a np.expressao retorna 0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F4dent</span>          <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&gt;</span><span class="mf">1.05</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&lt;=</span><span class="mf">1.05</span> <span class="ow">and</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">delta</span><span class="o">&lt;=</span><span class="mf">1.05</span> <span class="ow">and</span> <span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Valor final</span>
    <span class="n">SPLdent</span>             <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Lcdent</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">F4dent</span><span class="p">))</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1">## Ruído combinação, só para MTR supersônico ##</span>
    <span class="k">if</span>  <span class="n">MTR</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">F1c1_2</span>          <span class="o">=</span> <span class="p">(</span><span class="mf">318.49</span><span class="o">*</span><span class="n">MTR</span><span class="o">-</span><span class="mf">288.49</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.146</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">14.052</span><span class="o">*</span><span class="n">MTR</span><span class="o">+</span><span class="mf">92.603</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&gt;</span><span class="mf">1.146</span><span class="p">)</span>
        <span class="n">F1c1_4</span>          <span class="o">=</span> <span class="p">(</span><span class="mf">147.52</span><span class="o">*</span><span class="n">MTR</span><span class="o">-</span><span class="mf">117.52</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.322</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">13.274</span><span class="o">*</span><span class="n">MTR</span><span class="o">+</span><span class="mf">95.049</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&gt;</span><span class="mf">1.322</span><span class="p">)</span>
        <span class="n">F1c1_8</span>          <span class="o">=</span> <span class="p">(</span><span class="mf">67.541</span><span class="o">*</span><span class="n">MTR</span><span class="o">-</span><span class="mf">37.541</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.61</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mf">12.051</span><span class="o">*</span><span class="n">MTR</span><span class="o">+</span><span class="mf">90.603</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">MTR</span><span class="o">&gt;</span><span class="mf">1.61</span><span class="p">)</span>
        <span class="n">F2c</span>             <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetacb</span><span class="p">,</span><span class="n">F2cb</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">F3c1_2</span>          <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&lt;=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">F3c1_4</span>          <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&lt;=</span><span class="mf">0.25</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&gt;</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">F3c1_8</span>          <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&lt;=</span><span class="mf">0.125</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fb</span><span class="o">&gt;</span><span class="mf">0.125</span><span class="p">)</span>
        <span class="n">Lcc1_2</span>          <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1c1_2</span><span class="o">+</span><span class="n">F2c</span><span class="o">+</span><span class="n">F3c1_2</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Lcc1_4</span>          <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1c1_4</span><span class="o">+</span><span class="n">F2c</span><span class="o">+</span><span class="n">F3c1_4</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Lcc1_8</span>          <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1c1_8</span><span class="o">+</span><span class="n">F2c</span><span class="o">+</span><span class="n">F3c1_8</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">SPLc</span>            <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">Lcc1_2</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">Lcc1_4</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">Lcc1_8</span><span class="p">))</span><span class="o">-</span><span class="mi">17</span>      <span class="c1"># soma dos 3 espectros de frequencia</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SPLc</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

    <span class="c1">## Ruído da descarga do FAN ##</span>
    <span class="c1">## Ruído banda larga ##</span>
    <span class="c1"># Correção 01</span>
    <span class="k">if</span> <span class="n">MTRd</span><span class="o">&lt;=</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1bdesc</span>         <span class="o">=</span> <span class="mf">60.0</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1bdesc</span>         <span class="o">=</span> <span class="mf">60.0</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1bdesc</span>         <span class="o">=</span> <span class="mf">60.0</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F1bdesc</span>         <span class="o">=</span> <span class="mf">60.0</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="p">)</span>

    <span class="c1"># Correção 02</span>
    <span class="n">F2bdesc</span>             <span class="o">=</span> <span class="n">F2bent</span>                                               <span class="c1">#F2b é o mesmo do ruído da entrada no FAN.</span>
    <span class="c1"># Correção 03</span>
    <span class="n">F3bdesc</span>             <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetabldesc</span><span class="p">,</span><span class="n">F3bldesc</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
    <span class="c1"># Correção 04</span>
    <span class="n">F4bdesc</span>             <span class="o">=</span> <span class="n">F4bent</span>
    <span class="c1"># VAlor final</span>
    <span class="n">Lcbdesc</span>             <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1bdesc</span><span class="o">+</span><span class="n">F2bdesc</span><span class="o">+</span><span class="n">F3bdesc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SPLbdesc</span>            <span class="o">=</span> <span class="n">Lcbdesc</span><span class="o">+</span><span class="n">F4bdesc</span><span class="o">-</span><span class="mi">2</span>
    <span class="c1">## Ruído discreto ##</span>
    <span class="c1"># Correção 01</span>
    <span class="k">if</span> <span class="n">MTRd</span><span class="o">&lt;=</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1ddesc</span>         <span class="o">=</span> <span class="mf">63.0</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1ddesc</span>         <span class="o">=</span> <span class="mf">63.0</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">MTRd</span><span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">MTR</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
        <span class="n">F1ddesc</span>         <span class="o">=</span> <span class="mf">63.0</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTRd</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">F1ddesc</span>         <span class="o">=</span> <span class="mf">63.0</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">MTR</span><span class="p">)</span>

    <span class="c1"># Correção 02</span>
    <span class="n">F2ddesc</span>             <span class="o">=</span> <span class="n">F2dent</span>                                               <span class="c1"># F2d é o mesmo do ruído da entrada do FAN</span>
    <span class="c1"># Correção 03</span>
    <span class="n">F3ddesc</span>             <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetadsdesc</span><span class="p">,</span><span class="n">F3dsdesc</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
    <span class="c1"># Correção 04</span>
    <span class="n">F4ddesc</span>             <span class="o">=</span> <span class="n">F4dent</span>
    <span class="c1"># Valor final</span>
    <span class="n">Lcddesc</span>             <span class="o">=</span> <span class="n">SPL</span><span class="o">+</span><span class="n">F1ddesc</span><span class="o">+</span><span class="n">F2ddesc</span><span class="o">+</span><span class="n">F3ddesc</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">IGV</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># SPLddesc            = Lcddesc+F4ddesc-2</span>

    <span class="n">SPLddesc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ij</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">SPLddesc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aux1</span> <span class="o">=</span> <span class="n">Lcddesc</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">F4ddesc</span><span class="p">[</span><span class="n">ij</span><span class="p">]))</span><span class="o">-</span><span class="mi">2</span>
            <span class="n">SPLddesc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">aux1</span><span class="p">))</span>
    
    <span class="n">SPLddesc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SPLddesc</span><span class="p">)</span>
    <span class="c1">## amortecimento atmosférico ##</span>
    <span class="n">ft</span><span class="p">,</span> <span class="n">alfaamortt</span><span class="p">,</span> <span class="n">amorttott</span><span class="p">,</span> <span class="n">amortatm</span><span class="p">,</span> <span class="n">SPLrt</span> <span class="o">=</span> <span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">radialdistance</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>

    <span class="c1">## Efeito doppler ##</span>
    <span class="n">deltaLdoppler</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">40</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">M0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">))</span>

    <span class="c1">## soma dos ruídos banda larga de entrada e descarga do FAN ##</span>
    <span class="n">SPLb</span>                <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLbent</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLbdesc</span><span class="p">))</span>       <span class="c1"># método direto de soma</span>
    <span class="c1">## soma dos ruídos discretos de entrada e descarga do FAN ##</span>
    <span class="n">SPLd</span>                <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLdent</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLddesc</span><span class="p">))</span>       <span class="c1"># método direto de soma</span>


    <span class="c1">## soma dos ruidos discreto, banda larga e combinação ##</span>
    <span class="n">SPLFan</span>              <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLb</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLc</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLd</span><span class="p">))</span> 
                                                                                <span class="c1"># método direto de soma, considerando o amortecimento atmosférico</span>
                                                                                

    <span class="c1">## DADOS DE SAIDA ##</span>
    <span class="n">ruidoFan</span>            <span class="o">=</span> <span class="n">SPLFan</span><span class="o">-</span><span class="n">amorttott</span>
    <span class="n">ft</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ruidoFant</span>           <span class="o">=</span> <span class="n">ruidoFan</span><span class="o">.</span><span class="n">T</span>
    <span class="n">a1</span>                  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ruidoFant</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ia1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ruidoFant</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ruidoFant</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ft</span><span class="p">,</span> <span class="n">ruidoFant</span></div>



<div class="viewcode-block" id="achatom"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.achatom">[docs]</a><span class="k">def</span> <span class="nf">achatom</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">kprocess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">24</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">ik</span><span class="p">]</span><span class="o">==</span><span class="n">k</span><span class="p">[</span><span class="n">ik</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">kprocess</span><span class="p">[</span><span class="n">ik</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kprocess</span><span class="p">[</span><span class="n">ik</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">ik</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">kprocess</span></div>


<div class="viewcode-block" id="combustion_chamber"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.combustion_chamber">[docs]</a><span class="k">def</span> <span class="nf">combustion_chamber</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mdot</span><span class="p">,</span><span class="n">T3K</span><span class="p">,</span><span class="n">T4K</span><span class="p">,</span><span class="n">P3</span><span class="p">):</span>
    <span class="n">RH</span> <span class="o">=</span> <span class="n">noise_parameters</span><span class="p">[</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">]</span>


    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">3150</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">6300</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>

    <span class="c1">## Fatores de conversão</span>
    <span class="c1">#global m_to_ft deg_to_rad</span>

    <span class="n">deg_to_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>

    <span class="c1">## Tabelas para interpolação</span>
    <span class="n">tetatab</span>             <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
    <span class="n">OASPLPWLtab</span>         <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">32.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.2</span><span class="p">]</span>


    <span class="c1">## CORPO DA FUNÇÃO ##</span>
    <span class="c1">## Manipulação de dados de entrada ##</span>
    <span class="n">v0</span>                  <span class="o">=</span> <span class="n">vairp</span>                                                <span class="c1"># velocidade da aeronave [m/s]</span>
    <span class="n">radialdistance</span>      <span class="o">=</span> <span class="n">R</span>                                                    <span class="c1"># distância para avaliação do ruído [m]</span>

    <span class="c1">## Dados da atmosfera ##</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">atmosphere_ISA_deviation</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="n">delta_ISA</span><span class="p">)</span> <span class="c1"># propriedades da atmosfera</span>

    <span class="c1">## Cálculos iniciais ##</span>
    <span class="n">M0</span>                  <span class="o">=</span> <span class="n">v0</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span>                                              <span class="c1"># número de Mach da aeronave</span>

    <span class="c1">## Ruido da câmara de combustão ##</span>
    <span class="n">epsilon</span>             <span class="o">=</span> <span class="n">fi</span>
    <span class="n">OAPWL</span>               <span class="o">=</span> <span class="mf">56.5</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">mdot</span><span class="o">/</span><span class="mf">0.4536</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">T4K</span><span class="o">-</span><span class="n">T3K</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P3</span><span class="o">/</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">T3K</span><span class="p">)))</span> <span class="c1">#colocar temperatura total THIS LINE HAVE WRONG UNITS AT MATLABCDE P3[Pa] and P[KPa]</span>
    <span class="n">OASPLPWL</span>            <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetatab</span><span class="p">,</span><span class="n">OASPLPWLtab</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">OASPLtr</span>             <span class="o">=</span> <span class="n">OAPWL</span><span class="o">+</span><span class="n">OASPLPWL</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">radialdistance</span><span class="p">)</span>              <span class="c1"># SPLr está incluído</span>
    <span class="n">fp</span>                  <span class="o">=</span> <span class="mi">740</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">0.4536</span><span class="o">/</span><span class="n">mdot</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P3</span><span class="o">/</span><span class="mi">101325</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">288.15</span><span class="o">/</span><span class="n">T4K</span><span class="p">))</span>
    <span class="c1"># if (fp&lt;300) or (fp&gt;1000):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">fp</span><span class="o">&lt;</span><span class="mi">300</span><span class="p">,</span><span class="n">fp</span><span class="o">&gt;</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">fp</span><span class="o">=</span><span class="mi">400</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">f</span><span class="o">&lt;=</span><span class="n">fp</span><span class="p">):</span>
        <span class="n">SPLf</span>            <span class="o">=</span> <span class="mf">15.02</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="o">+</span><span class="mf">65.92</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mf">108.33</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mf">75.37</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mf">2.96</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mf">1.48</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SPLf</span>            <span class="o">=</span> <span class="mf">0.20</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="o">-</span><span class="mf">1.02</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">5</span><span class="o">+</span><span class="mf">1.21</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mf">2.72</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mf">11.54</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fp</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span>

    <span class="n">SPLftr</span>              <span class="o">=</span> <span class="n">SPLf</span><span class="o">+</span><span class="n">OASPLtr</span>


    <span class="c1">## Amortecimento atmosférico ##</span>
    <span class="n">ft</span><span class="p">,</span> <span class="n">alfaamortt</span><span class="p">,</span> <span class="n">amorttott</span><span class="p">,</span> <span class="n">amortatm</span><span class="p">,</span> <span class="n">SPLrt</span> <span class="o">=</span> <span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">radialdistance</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>

    <span class="c1">## Efeito doppler ##</span>
    <span class="n">deltaLdoppler</span>       <span class="o">=</span> <span class="o">-</span><span class="mi">40</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">M0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">epsilon</span><span class="o">*</span><span class="n">deg_to_rad</span><span class="p">))</span>


    <span class="c1">## DADOS DE SAIDA ##</span>
    <span class="n">Ruidocamara</span>         <span class="o">=</span> <span class="n">SPLftr</span><span class="o">-</span><span class="n">amortatm</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="n">deltaLdoppler</span>
    <span class="n">ft</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ruidocamarat</span>        <span class="o">=</span> <span class="n">Ruidocamara</span><span class="o">.</span><span class="n">T</span>
    <span class="n">a1</span>                  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ruidocamarat</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ia1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ruidocamarat</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ruidocamarat</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">ft</span><span class="p">,</span> <span class="n">ruidocamarat</span></div>


<div class="viewcode-block" id="turbine"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.turbine">[docs]</a><span class="k">def</span> <span class="nf">turbine</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mdot</span><span class="p">,</span><span class="n">nturb</span><span class="p">,</span><span class="n">Tturbsaida</span><span class="p">,</span><span class="n">MTRturb</span><span class="p">,</span><span class="n">nrotor</span><span class="p">,</span><span class="n">RSSturb</span><span class="p">):</span>

    <span class="n">RH</span> <span class="o">=</span> <span class="n">noise_parameters</span><span class="p">[</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">3150</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">6300</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>

    <span class="c1">## Fatores de conversão</span>
    <span class="c1">#global m_to_ft deg2rad</span>

    <span class="n">deg2rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>

    <span class="c1">## Tabelas para interpolação</span>
    <span class="n">tetatab</span>             <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mf">180.1</span><span class="p">])</span>
    <span class="n">F1tab</span>               <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">37.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">07.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">04.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">00.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">01.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">05.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">09.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">24.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.0</span><span class="p">])</span>
    <span class="n">F3tab</span>               <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">48.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">37.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">05.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">02.3</span><span class="p">,</span> <span class="mf">00.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">02.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">08.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">38.0</span><span class="p">])</span>


    <span class="c1">## CORPO DA FUNÇÃO ##</span>
    <span class="c1">## Manipulação de dados de entrada ##</span>
    <span class="n">v0</span>                  <span class="o">=</span> <span class="n">vairp</span>                                                <span class="c1"># velocidade da aeronave [m/s]</span>
    <span class="n">epsilon</span>             <span class="o">=</span> <span class="n">fi</span>
    <span class="n">radialdistance</span>      <span class="o">=</span> <span class="n">R</span>                                                    <span class="c1"># distância para avaliação do ruído [m]</span>

    <span class="c1">## Dados da atmosfera ##</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">atmosphere_ISA_deviation</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># propriedades da atmosfera                          # propriedades da atmosfera</span>
    <span class="c1"># T                   = atm(1)                                               # temperatura ambiente [K]</span>
    <span class="c1"># (a*kt_to_ms)                = atm(7)                                               # velocidade do som [m/s]</span>


    <span class="c1">## Cálculos iniciais ##</span>
    <span class="n">M0</span>                  <span class="o">=</span> <span class="n">v0</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span>                                              <span class="c1"># número de Mach da aeronave</span>

    <span class="c1">## Ruido da turbina ##</span>
    <span class="n">F1</span>                  <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetatab</span><span class="p">,</span><span class="n">F1tab</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">F3</span>                  <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tetatab</span><span class="p">,</span><span class="n">F3tab</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1">## Ruido banda larga ##</span>
    <span class="n">termo1</span>              <span class="o">=</span> <span class="p">((</span><span class="n">MTRturb</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span><span class="o">/</span><span class="mf">0.305</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">340.3</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)))</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">termo2</span>              <span class="o">=</span> <span class="p">(</span><span class="n">mdot</span><span class="o">/</span><span class="mf">0.4536</span><span class="p">)</span>
    <span class="n">termo3</span>              <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">M0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">epsilon</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">))</span>
    <span class="n">SPLpeak</span>             <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">termo1</span><span class="o">*</span><span class="n">termo2</span><span class="o">*</span><span class="n">termo3</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">F1</span><span class="o">-</span><span class="mi">10</span>
    <span class="n">f0</span>                  <span class="o">=</span> <span class="n">nrotor</span><span class="o">*</span><span class="n">nturb</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="n">termo3</span>
    <span class="k">if</span> <span class="n">f0</span><span class="o">&gt;</span><span class="mi">10000</span><span class="p">:</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="mi">10000</span>

    <span class="n">Fb</span>                  <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">&lt;</span><span class="n">f0</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">&gt;=</span><span class="n">f0</span><span class="p">)</span>
    <span class="n">SPLbl</span>               <span class="o">=</span> <span class="n">SPLpeak</span><span class="o">+</span><span class="n">Fb</span>


    <span class="c1">## Ruido discreto ##</span>
    <span class="n">termo1</span>              <span class="o">=</span> <span class="p">(</span><span class="n">MTRturb</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span><span class="o">/</span><span class="mf">0.305</span><span class="p">)</span><span class="o">**</span><span class="mf">0.6</span><span class="o">*</span><span class="p">(</span><span class="mf">340.3</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">termo2</span>              <span class="o">=</span> <span class="p">(</span><span class="n">mdot</span><span class="o">/</span><span class="mf">0.4536</span><span class="p">)</span>
    <span class="n">termo3</span>              <span class="o">=</span> <span class="p">(</span><span class="n">RSSturb</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">termo4</span>              <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">M0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">epsilon</span><span class="o">*</span><span class="n">deg2rad</span><span class="p">))</span>
    <span class="c1">#</span>
    <span class="n">SPLtone</span>             <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">termo1</span><span class="o">*</span><span class="n">termo2</span><span class="o">*</span><span class="n">termo3</span><span class="o">*</span><span class="n">termo4</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">F3</span><span class="o">+</span><span class="mi">56</span>
    <span class="c1">#</span>
    <span class="n">f1</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">f2</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="c1"># k                   = 1:10000/f0   # REVIEWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW</span>
    <span class="n">k</span>  <span class="o">=</span> <span class="mi">1</span>
    <span class="n">SPLdisc</span>             <span class="o">=</span> <span class="n">SPLtone</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">## Colocação dos tons ##</span>
    <span class="c1"># ftom = zeros(size(f))</span>
    
    <span class="c1"># for j in range(1,(10000/f0)):</span>
    <span class="c1">#     ftom[:,j]       = f*((j*f0)&gt;f1 and (j*f0)&lt;f2)                           # acha as frequencias em que deve ser colocado o tom, em formato de j colunas</span>
    <span class="n">ftom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ftom</span><span class="p">)):</span>
        <span class="c1"># if np.any((j*f0)&gt;f1) and np.all((j*f0)&lt;f2):</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">&gt;</span><span class="n">f1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">f0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">f2</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">ftom</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>       <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ftom</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>       <span class="o">=</span> <span class="mi">0</span>

        

    

    <span class="c1"># ftom[:,j]       = f*((j*f0)&gt;f1 and (j*f0)&lt;f2)  </span>
    <span class="c1"># ftons               = np.sum(ftom, axis = 1)                                        # acha as frequencias em formato de uma coluna</span>
    <span class="n">ftons</span>               <span class="o">=</span> <span class="n">ftom</span><span class="o">.</span><span class="n">T</span>                                               <span class="c1"># transpoe a matriz e obtem um vetor 1x24</span>
    <span class="n">SPLd</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">i</span>                   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">ftons</span><span class="p">)</span>                                          <span class="c1"># retorna as posições dos valores de ftons que não são zeros</span>
    <span class="n">I1</span>                  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>                                         <span class="c1"># avalia a quantidade de frequências nas quais devem ser colocados os tons</span>
    <span class="n">I2</span>                  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">SPLdisc</span><span class="p">))</span>                                   <span class="c1"># avalia a quantidade de tons</span>
    <span class="n">I3</span>                  <span class="o">=</span> <span class="n">I1</span><span class="o">/</span><span class="n">I2</span>                                                <span class="c1"># verifica se é um múltiplo inteiro</span>
    <span class="n">I4</span>                  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">I1</span><span class="o">/</span><span class="n">I2</span><span class="p">)</span>                                         <span class="c1"># verifica se é um múltiplo inteiro</span>
    <span class="k">if</span> <span class="n">I1</span><span class="o">&gt;</span><span class="n">I2</span><span class="p">:</span>                                                                    <span class="c1"># verifica se há mais frequências que tons</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">I3</span><span class="o">-</span><span class="n">I4</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>                                                           <span class="c1"># verifica se é um múltiplo inteiro</span>
            <span class="k">for</span> <span class="n">ai2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">I2</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">ai1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">I3</span><span class="p">):</span>
                    <span class="n">SPLdisca</span><span class="p">[</span><span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="n">ai2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">ai1</span><span class="p">]</span> <span class="o">=</span> <span class="n">SPLdisc</span><span class="p">[</span><span class="n">ai2</span><span class="p">]</span>                    <span class="c1"># redimensiona a matriz de tons</span>
        <span class="n">SPLdisc</span>         <span class="o">=</span> <span class="n">SPLdisca</span>                                             <span class="c1"># redimensiona a matriz de tons</span>


    <span class="n">SPLd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>             <span class="o">=</span> <span class="n">SPLd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">SPLdisc</span>                                      <span class="c1"># coloca os tons</span>


    <span class="c1">## Soma dos ruidos discreto e banda larga ##</span>
    <span class="n">SPLturb</span>             <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLbl</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">SPLd</span><span class="p">))</span>

    <span class="c1">## Amortecimento atmosférico ##</span>
    <span class="n">ft</span><span class="p">,</span> <span class="n">alfaamortt</span><span class="p">,</span> <span class="n">amorttott</span><span class="p">,</span> <span class="n">amortatm</span><span class="p">,</span> <span class="n">SPLrt</span> <span class="o">=</span> <span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">radialdistance</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
    <span class="c1">## Extrapolando o espectro para um metro ##</span>
    <span class="n">deltaLamort1m</span>       <span class="o">=</span> <span class="n">alfaamortt</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="mf">45.72</span><span class="o">/</span><span class="mi">100</span>                                 <span class="c1"># para transformar em um metro</span>
    <span class="n">amortatm1m</span>          <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">deltaLamort1m</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">ruido1m</span>             <span class="o">=</span> <span class="n">SPLturb</span><span class="o">+</span><span class="mf">33.2</span><span class="o">+</span><span class="n">amortatm1m</span>                              <span class="c1"># 33.2=20*np.log10(45.72)</span>


    <span class="c1">## DADOS DE SAIDA ##</span>
    <span class="n">ruidoTurbina</span>        <span class="o">=</span> <span class="n">ruido1m</span><span class="o">-</span><span class="n">amortatm</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">SPLrt</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ft</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ruidoTurbinat</span>       <span class="o">=</span> <span class="n">ruidoTurbina</span><span class="o">.</span><span class="n">T</span>
    <span class="n">a1</span>                  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ruidoTurbinat</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ia1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ruidoTurbinat</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ruidoTurbinat</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ft</span><span class="p">,</span> <span class="n">ruidoTurbinat</span></div>


<div class="viewcode-block" id="nozzle"><a class="viewcode-back" href="../../../../framework.Noise.Noise_Smith.html#framework.Noise.Noise_Smith.noise_engine.nozzle">[docs]</a><span class="k">def</span> <span class="nf">nozzle</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span><span class="n">delta_ISA</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">vairp</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">fi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">plug</span><span class="p">,</span><span class="n">coaxial</span><span class="p">,</span><span class="n">ACJ</span><span class="p">,</span><span class="n">ABJ</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">DCJ</span><span class="p">,</span><span class="n">VCJ</span><span class="p">,</span><span class="n">VBJ</span><span class="p">,</span><span class="n">TCJ</span><span class="p">,</span><span class="n">TBJ</span><span class="p">,</span><span class="n">roCJ</span><span class="p">,</span><span class="n">roBJ</span><span class="p">):</span>

    <span class="n">RH</span> <span class="o">=</span> <span class="n">noise_parameters</span><span class="p">[</span><span class="s1">&#39;relative_humidity&#39;</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">3150</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">6300</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>


    <span class="c1">## Fatores de conversão</span>
    <span class="c1">#global m_to_ft deg_to_rad</span>
    <span class="n">deg_to_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>


    <span class="c1">## Tabelas para interpolação</span>
    <span class="n">ARPtab</span>              <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="o">.</span><span class="mi">35</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">45</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">55</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">])</span>
    <span class="n">VRtab</span>               <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">FSPtab</span>              <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">,</span> <span class="mf">19.0</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">27.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">17.0</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">31.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">46.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">51.0</span><span class="p">,</span> <span class="mf">53.0</span><span class="p">,</span> <span class="mf">55.0</span><span class="p">,</span> <span class="mf">57.0</span><span class="p">,</span> <span class="mf">59.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">,</span> <span class="mf">63.0</span><span class="p">,</span> <span class="mf">65.0</span><span class="p">,</span> <span class="mf">66.0</span><span class="p">,</span> <span class="mf">68.0</span><span class="p">,</span> <span class="mf">69.0</span><span class="p">,</span> <span class="mf">71.0</span><span class="p">,</span> <span class="mf">72.0</span><span class="p">,</span> <span class="mf">73.0</span><span class="p">,</span> <span class="mf">74.0</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">77.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="mf">79.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">23.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">33.0</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">51.0</span><span class="p">,</span> <span class="mf">53.0</span><span class="p">,</span> <span class="mf">56.0</span><span class="p">,</span> <span class="mf">59.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">,</span> <span class="mf">64.0</span><span class="p">,</span> <span class="mf">65.0</span><span class="p">,</span> <span class="mf">67.0</span><span class="p">,</span> <span class="mf">69.0</span><span class="p">,</span> <span class="mf">71.0</span><span class="p">,</span> <span class="mf">73.0</span><span class="p">,</span> <span class="mf">74.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mf">77.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="mf">79.0</span><span class="p">,</span> <span class="mf">81.0</span><span class="p">,</span> <span class="mf">82.0</span><span class="p">,</span> <span class="mf">83.0</span><span class="p">,</span> <span class="mf">84.0</span><span class="p">,</span> <span class="mf">85.0</span><span class="p">,</span> <span class="mf">86.0</span><span class="p">,</span> <span class="mf">87.0</span><span class="p">,</span> <span class="mf">88.0</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">33.0</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">46.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">52.0</span><span class="p">,</span> <span class="mf">54.0</span><span class="p">,</span> <span class="mf">56.0</span><span class="p">,</span> <span class="mf">59.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">,</span> <span class="mf">63.0</span><span class="p">,</span> <span class="mf">64.0</span><span class="p">,</span> <span class="mf">65.0</span><span class="p">,</span> <span class="mf">68.0</span><span class="p">,</span> <span class="mf">69.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">72.0</span><span class="p">,</span> <span class="mf">73.0</span><span class="p">,</span> <span class="mf">74.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">77.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">81.0</span><span class="p">,</span> <span class="mf">82.0</span><span class="p">,</span> <span class="mf">82.5</span><span class="p">,</span>
    <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">23.0</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">32.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">41.0</span><span class="p">,</span> <span class="mf">43.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">52.0</span><span class="p">,</span> <span class="mf">54.0</span><span class="p">,</span> <span class="mf">56.0</span><span class="p">,</span> <span class="mf">58.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">,</span> <span class="mf">63.0</span><span class="p">,</span> <span class="mf">65.0</span><span class="p">,</span> <span class="mf">66.0</span><span class="p">,</span> <span class="mf">67.0</span><span class="p">,</span> <span class="mf">69.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">71.0</span><span class="p">,</span> <span class="mf">73.0</span><span class="p">,</span> <span class="mf">74.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">77.0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">logStab</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">])</span>
    <span class="n">tetatab</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">109.9</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mf">180.1</span><span class="p">])</span>
    <span class="n">SDLtab</span>              <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">39.1</span><span class="p">,</span> <span class="mf">36.8</span><span class="p">,</span> <span class="mf">34.5</span><span class="p">,</span> <span class="mf">32.3</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">27.7</span><span class="p">,</span> <span class="mf">25.4</span><span class="p">,</span> <span class="mf">23.2</span><span class="p">,</span> <span class="mf">21.1</span><span class="p">,</span> <span class="mf">19.1</span><span class="p">,</span> <span class="mf">17.4</span><span class="p">,</span> <span class="mf">15.9</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="mf">13.7</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">,</span> <span class="mf">11.2</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">,</span> <span class="mf">11.7</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">13.7</span><span class="p">,</span> <span class="mf">14.6</span><span class="p">,</span> <span class="mf">15.6</span><span class="p">,</span> <span class="mf">16.7</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mf">18.9</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">22.4</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="mf">24.8</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">,</span> <span class="mf">27.2</span><span class="p">,</span>
    <span class="mf">42.4</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">37.6</span><span class="p">,</span> <span class="mf">35.2</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">30.4</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">,</span> <span class="mf">25.6</span><span class="p">,</span> <span class="mf">23.2</span><span class="p">,</span> <span class="mf">20.8</span><span class="p">,</span> <span class="mf">18.5</span><span class="p">,</span> <span class="mf">16.2</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">09.9</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.6</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">,</span> <span class="mf">12.7</span><span class="p">,</span> <span class="mf">13.7</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="mf">15.8</span><span class="p">,</span> <span class="mf">16.9</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">,</span> <span class="mf">20.4</span><span class="p">,</span> <span class="mf">21.6</span><span class="p">,</span> <span class="mf">22.8</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">,</span> <span class="mf">25.2</span><span class="p">,</span> <span class="mf">26.4</span><span class="p">,</span> <span class="mf">27.6</span><span class="p">,</span> <span class="mf">28.8</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span>
    <span class="mf">43.0</span><span class="p">,</span> <span class="mf">40.2</span><span class="p">,</span> <span class="mf">37.4</span><span class="p">,</span> <span class="mf">34.6</span><span class="p">,</span> <span class="mf">31.8</span><span class="p">,</span> <span class="mf">29.0</span><span class="p">,</span> <span class="mf">26.2</span><span class="p">,</span> <span class="mf">23.4</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">13.1</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">09.6</span><span class="p">,</span> <span class="mf">09.3</span><span class="p">,</span> <span class="mf">09.6</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">11.4</span><span class="p">,</span> <span class="mf">12.7</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">15.3</span><span class="p">,</span> <span class="mf">16.6</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">19.3</span><span class="p">,</span> <span class="mf">20.7</span><span class="p">,</span> <span class="mf">22.0</span><span class="p">,</span> <span class="mf">23.4</span><span class="p">,</span> <span class="mf">24.7</span><span class="p">,</span> <span class="mf">26.1</span><span class="p">,</span> <span class="mf">27.5</span><span class="p">,</span> <span class="mf">28.8</span><span class="p">,</span> <span class="mf">30.2</span><span class="p">,</span> <span class="mf">31.5</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">34.1</span><span class="p">,</span> <span class="mf">35.5</span><span class="p">,</span>
    <span class="mf">44.5</span><span class="p">,</span> <span class="mf">41.3</span><span class="p">,</span> <span class="mf">38.2</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">31.8</span><span class="p">,</span> <span class="mf">28.7</span><span class="p">,</span> <span class="mf">25.5</span><span class="p">,</span> <span class="mf">22.4</span><span class="p">,</span> <span class="mf">19.3</span><span class="p">,</span> <span class="mf">16.1</span><span class="p">,</span> <span class="mf">13.2</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">09.4</span><span class="p">,</span> <span class="mf">09.1</span><span class="p">,</span> <span class="mf">09.4</span><span class="p">,</span> <span class="mf">09.9</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">12.4</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">15.6</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">,</span> <span class="mf">18.8</span><span class="p">,</span> <span class="mf">20.4</span><span class="p">,</span> <span class="mf">22.1</span><span class="p">,</span> <span class="mf">23.7</span><span class="p">,</span> <span class="mf">25.3</span><span class="p">,</span> <span class="mf">26.9</span><span class="p">,</span> <span class="mf">28.5</span><span class="p">,</span> <span class="mf">30.1</span><span class="p">,</span> <span class="mf">31.7</span><span class="p">,</span> <span class="mf">33.3</span><span class="p">,</span> <span class="mf">34.9</span><span class="p">,</span> <span class="mf">36.5</span><span class="p">,</span> <span class="mf">38.1</span><span class="p">,</span> <span class="mf">39.7</span><span class="p">,</span> <span class="mf">41.3</span><span class="p">,</span>
    <span class="mf">42.4</span><span class="p">,</span> <span class="mf">39.3</span><span class="p">,</span> <span class="mf">36.2</span><span class="p">,</span> <span class="mf">33.1</span><span class="p">,</span> <span class="mf">29.9</span><span class="p">,</span> <span class="mf">26.9</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">,</span> <span class="mf">09.9</span><span class="p">,</span> <span class="mf">08.3</span><span class="p">,</span> <span class="mf">07.7</span><span class="p">,</span> <span class="mf">08.3</span><span class="p">,</span> <span class="mf">09.7</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">,</span> <span class="mf">13.4</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">17.0</span><span class="p">,</span> <span class="mf">18.8</span><span class="p">,</span> <span class="mf">20.6</span><span class="p">,</span> <span class="mf">22.3</span><span class="p">,</span> <span class="mf">24.1</span><span class="p">,</span> <span class="mf">25.9</span><span class="p">,</span> <span class="mf">27.7</span><span class="p">,</span> <span class="mf">29.5</span><span class="p">,</span> <span class="mf">31.3</span><span class="p">,</span> <span class="mf">33.1</span><span class="p">,</span> <span class="mf">34.9</span><span class="p">,</span> <span class="mf">36.7</span><span class="p">,</span> <span class="mf">38.5</span><span class="p">,</span> <span class="mf">40.3</span><span class="p">,</span> <span class="mf">42.0</span><span class="p">,</span> <span class="mf">43.8</span><span class="p">,</span> <span class="mf">45.6</span><span class="p">,</span> <span class="mf">47.4</span><span class="p">,</span>
    <span class="mf">36.4</span><span class="p">,</span> <span class="mf">31.9</span><span class="p">,</span> <span class="mf">27.9</span><span class="p">,</span> <span class="mf">24.3</span><span class="p">,</span> <span class="mf">21.1</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">15.9</span><span class="p">,</span> <span class="mf">13.8</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">,</span> <span class="mf">10.8</span><span class="p">,</span> <span class="mf">09.9</span><span class="p">,</span> <span class="mf">09.2</span><span class="p">,</span> <span class="mf">08.7</span><span class="p">,</span> <span class="mf">09.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">13.9</span><span class="p">,</span> <span class="mf">15.8</span><span class="p">,</span> <span class="mf">17.7</span><span class="p">,</span> <span class="mf">19.6</span><span class="p">,</span> <span class="mf">21.5</span><span class="p">,</span> <span class="mf">23.4</span><span class="p">,</span> <span class="mf">25.3</span><span class="p">,</span> <span class="mf">27.2</span><span class="p">,</span> <span class="mf">29.1</span><span class="p">,</span> <span class="mf">31.0</span><span class="p">,</span> <span class="mf">32.9</span><span class="p">,</span> <span class="mf">34.8</span><span class="p">,</span> <span class="mf">36.7</span><span class="p">,</span> <span class="mf">38.6</span><span class="p">,</span> <span class="mf">40.5</span><span class="p">,</span> <span class="mf">42.4</span><span class="p">,</span> <span class="mf">44.3</span><span class="p">,</span> <span class="mf">46.2</span><span class="p">,</span> <span class="mf">48.1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">51.9</span><span class="p">,</span>
    <span class="mf">32.8</span><span class="p">,</span> <span class="mf">28.7</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">,</span> <span class="mf">21.7</span><span class="p">,</span> <span class="mf">18.8</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">09.8</span><span class="p">,</span> <span class="mf">09.0</span><span class="p">,</span> <span class="mf">08.5</span><span class="p">,</span> <span class="mf">09.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">,</span> <span class="mf">13.8</span><span class="p">,</span> <span class="mf">15.8</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mf">19.8</span><span class="p">,</span> <span class="mf">21.8</span><span class="p">,</span> <span class="mf">23.8</span><span class="p">,</span> <span class="mf">25.8</span><span class="p">,</span> <span class="mf">27.8</span><span class="p">,</span> <span class="mf">29.8</span><span class="p">,</span> <span class="mf">31.8</span><span class="p">,</span> <span class="mf">33.8</span><span class="p">,</span> <span class="mf">35.8</span><span class="p">,</span> <span class="mf">37.8</span><span class="p">,</span> <span class="mf">39.8</span><span class="p">,</span> <span class="mf">41.8</span><span class="p">,</span> <span class="mf">43.8</span><span class="p">,</span> <span class="mf">45.8</span><span class="p">,</span> <span class="mf">47.8</span><span class="p">,</span> <span class="mf">49.8</span><span class="p">,</span> <span class="mf">51.8</span><span class="p">,</span> <span class="mf">53.8</span><span class="p">,</span> <span class="mf">55.8</span><span class="p">,</span>
    <span class="mf">29.4</span><span class="p">,</span> <span class="mf">25.6</span><span class="p">,</span> <span class="mf">22.2</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">,</span> <span class="mf">16.6</span><span class="p">,</span> <span class="mf">14.3</span><span class="p">,</span> <span class="mf">12.4</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">09.7</span><span class="p">,</span> <span class="mf">08.9</span><span class="p">,</span> <span class="mf">08.4</span><span class="p">,</span> <span class="mf">08.9</span><span class="p">,</span> <span class="mf">09.9</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">,</span> <span class="mf">13.9</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">,</span> <span class="mf">18.1</span><span class="p">,</span> <span class="mf">20.2</span><span class="p">,</span> <span class="mf">22.3</span><span class="p">,</span> <span class="mf">24.4</span><span class="p">,</span> <span class="mf">26.5</span><span class="p">,</span> <span class="mf">28.6</span><span class="p">,</span> <span class="mf">30.7</span><span class="p">,</span> <span class="mf">32.8</span><span class="p">,</span> <span class="mf">34.9</span><span class="p">,</span> <span class="mf">37.0</span><span class="p">,</span> <span class="mf">39.1</span><span class="p">,</span> <span class="mf">41.2</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">,</span> <span class="mf">45.4</span><span class="p">,</span> <span class="mf">47.5</span><span class="p">,</span> <span class="mf">49.6</span><span class="p">,</span> <span class="mf">51.7</span><span class="p">,</span> <span class="mf">53.8</span><span class="p">,</span> <span class="mf">55.9</span><span class="p">,</span> <span class="mf">58.0</span><span class="p">,</span> <span class="mf">60.1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

                        
    <span class="c1">## CORPO DA FUNÇÃO ##</span>
    <span class="c1">## Manipulação de dados de entrada ##</span>
    <span class="n">Acorejet</span>            <span class="o">=</span> <span class="n">ACJ</span>                                                  <span class="c1"># área do jato central [m²]</span>
    <span class="n">Abypassjet</span>          <span class="o">=</span> <span class="n">ABJ</span>                                                  <span class="c1"># area do jato perfiférico [m²]</span>
    <span class="n">hgap</span>                <span class="o">=</span> <span class="n">h</span>                                                    <span class="c1"># diferença entre os diâmetros do jato central e do plug [m]</span>
    <span class="n">D</span>                   <span class="o">=</span> <span class="n">DCJ</span>                                                  <span class="c1"># diâmetro dojato central [m]</span>
    <span class="n">De</span>                  <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">hgap</span><span class="o">-</span><span class="n">hgap</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                                <span class="c1"># diâmetro equivalente [m]</span>
    <span class="n">v0</span>                  <span class="o">=</span> <span class="n">vairp</span>                                                <span class="c1"># velocidade da aeronave [m/s]</span>
    <span class="n">radialdistance</span>      <span class="o">=</span> <span class="n">R</span>                                                    <span class="c1"># distância para avaliação do ruído [m]</span>


    <span class="c1">## Dados da atmosfera ##</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">atmosphere_ISA_deviation</span><span class="p">(</span><span class="n">altitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> 


    <span class="c1">## Cálculos iniciais ##</span>
    <span class="n">M0</span>                  <span class="o">=</span> <span class="n">v0</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span>                                              <span class="c1"># número de Mach da aeronave</span>
    <span class="n">tetalinha</span>           <span class="o">=</span> <span class="n">theta</span><span class="o">*</span><span class="p">(</span><span class="n">VCJ</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">**</span><span class="mf">0.1</span>                                  <span class="c1"># ângulo efetivo para cálculo do ruído</span>
    <span class="n">w</span>                   <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">VCJ</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">**</span><span class="mf">3.5</span><span class="o">/</span><span class="p">(</span><span class="mf">0.60</span><span class="o">+</span><span class="p">(</span><span class="n">VCJ</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">**</span><span class="mf">3.5</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>             <span class="c1"># expoente de correção do ruído devido à densidade do jato de escape</span>
    <span class="n">vrel</span>                <span class="o">=</span> <span class="p">(</span><span class="n">VCJ</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v0</span><span class="o">/</span><span class="n">VCJ</span><span class="p">)</span><span class="o">**</span><span class="mf">0.75</span>                           <span class="c1"># velocidade relativa do escoamento</span>
    <span class="n">Mc</span>                  <span class="o">=</span> <span class="mf">0.62</span><span class="o">*</span><span class="p">(</span><span class="n">VCJ</span><span class="o">-</span><span class="n">v0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span>                                   <span class="c1"># razão entre a velocidade relativa do jato ao avião e a velocidade do som</span>

    <span class="c1">## Ruido para jato circular ##</span>
    <span class="n">OASPLcirc</span>           <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Acorejet</span><span class="o">/</span><span class="n">radialdistance</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="mf">1.225</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span><span class="o">/</span><span class="mi">340</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">vrel</span><span class="o">**</span><span class="mf">3.5</span><span class="o">/</span><span class="p">(</span><span class="mf">0.6</span><span class="o">+</span><span class="n">vrel</span><span class="o">**</span><span class="mf">3.5</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">roCJ</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span><span class="o">+</span><span class="mi">141</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vrel</span><span class="o">**</span><span class="mf">7.5</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">vrel</span><span class="o">**</span><span class="mf">4.5</span><span class="p">))</span>

    <span class="c1">## Ruido para jato plugue ##</span>
    <span class="n">termo1</span>              <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">Acorejet</span><span class="o">/</span><span class="n">radialdistance</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="mf">1.225</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">a</span><span class="o">*</span><span class="n">kt_to_ms</span><span class="p">)</span><span class="o">/</span><span class="mf">340.3</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">termo2</span>              <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">vrel</span><span class="o">**</span><span class="mf">3.5</span><span class="o">/</span><span class="p">(</span><span class="mf">0.6</span><span class="o">+</span><span class="n">vrel</span><span class="o">**</span><span class="mf">3.5</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">roCJ</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">termo3</span>              <span class="o">=</span> <span class="mi">141</span>
    <span class="n">termo4</span>              <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">hgap</span><span class="o">/</span><span class="n">D</span><span class="p">)</span>
    <span class="n">termo5</span>              <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vrel</span><span class="o">**</span><span class="mf">7.5</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">vrel</span><span class="o">**</span><span class="mf">4.5</span><span class="p">))</span>
    <span class="n">OASPLplug</span>           <span class="o">=</span> <span class="n">termo1</span><span class="o">+</span><span class="n">termo2</span><span class="o">+</span><span class="n">termo3</span><span class="o">+</span><span class="n">termo4</span><span class="o">+</span><span class="n">termo5</span>

    <span class="c1">## Ruido para jato coaxial, plugue ou circular ##</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Abypassjet</span><span class="o">/</span><span class="n">Acorejet</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">29.7</span><span class="p">:</span>
        <span class="n">m</span>               <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Abypassjet</span><span class="o">/</span><span class="n">Acorejet</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span>               <span class="o">=</span> <span class="mf">6.0</span>

    <span class="n">termo1</span>              <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">TCJ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TBJ</span><span class="p">))</span>
    <span class="n">termo2</span>              <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">VBJ</span><span class="o">/</span><span class="n">VCJ</span><span class="p">)</span><span class="o">**</span><span class="n">m</span>
    <span class="n">termo3</span>              <span class="o">=</span> <span class="mf">1.2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">Abypassjet</span><span class="o">*</span><span class="n">VBJ</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Acorejet</span><span class="o">*</span><span class="n">VCJ</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">termo4</span>              <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">Abypassjet</span><span class="o">/</span><span class="n">Acorejet</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">deltaOASPLcoaxial</span>   <span class="o">=</span> <span class="n">termo1</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">termo2</span><span class="o">+</span><span class="n">termo3</span><span class="o">/</span><span class="n">termo4</span><span class="p">)</span>
    <span class="n">OASPL90plug</span>         <span class="o">=</span> <span class="n">OASPLplug</span><span class="o">+</span><span class="n">deltaOASPLcoaxial</span>
    <span class="n">OASPL90circ</span>         <span class="o">=</span> <span class="n">OASPLcirc</span><span class="o">+</span><span class="n">deltaOASPLcoaxial</span>

    <span class="n">ARP</span>                 <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">Abypassjet</span><span class="o">/</span><span class="n">Acorejet</span><span class="p">)</span>                         <span class="c1"># Area ratio parameter</span>
    <span class="n">vratio</span>              <span class="o">=</span> <span class="n">VBJ</span><span class="o">/</span><span class="n">VCJ</span>
    <span class="n">minvratio</span>           <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">VRtab</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vratio</span><span class="o">&lt;</span><span class="n">minvratio</span><span class="p">:</span>
        <span class="n">VBJ</span>      <span class="o">=</span> <span class="n">minvratio</span><span class="o">*</span><span class="n">VCJ</span>

    <span class="n">FSP_f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp2d</span><span class="p">(</span><span class="n">VRtab</span><span class="p">,</span><span class="n">ARPtab</span><span class="p">,</span><span class="n">FSPtab</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>

    <span class="n">FSP</span> <span class="o">=</span> <span class="n">FSP_f</span><span class="p">(</span><span class="n">VBJ</span><span class="o">/</span><span class="n">VCJ</span><span class="p">,</span><span class="n">ARP</span><span class="p">)</span>

    <span class="c1">## Correção espectral</span>
    <span class="n">S_S1</span>                <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">FSP</span><span class="o">*</span><span class="p">((</span><span class="n">TBJ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TCJ</span><span class="p">)))</span>
    <span class="n">termo1</span>              <span class="o">=</span> <span class="n">S_S1</span>
    <span class="n">termo2</span>              <span class="o">=</span> <span class="n">De</span><span class="o">/</span><span class="n">VCJ</span>
    <span class="n">termo3</span>              <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">hgap</span><span class="o">/</span><span class="n">De</span><span class="p">)</span><span class="o">**</span><span class="mf">0.4</span>
    <span class="n">termo4</span>              <span class="o">=</span> <span class="p">((</span><span class="n">TCJ</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">0.4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tetalinha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)))</span>
    <span class="n">S_f</span>                 <span class="o">=</span> <span class="n">termo1</span><span class="o">*</span><span class="n">termo2</span><span class="o">*</span><span class="n">termo3</span><span class="o">*</span><span class="n">termo4</span>
    <span class="n">logS</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">S_f</span><span class="o">*</span><span class="n">f</span><span class="p">)</span>

    <span class="c1">## Espectro de frequências ##</span>
    <span class="n">cdf</span>                 <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">Mc</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">Mc</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mf">0.2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">deg_to_rad</span><span class="p">)</span>        <span class="c1"># ordenada do gráfico do espectro #</span>
    <span class="k">if</span> <span class="n">tetalinha</span><span class="o">&lt;</span><span class="mi">110</span><span class="p">:</span>
        <span class="n">tetalinha</span>       <span class="o">=</span> <span class="mi">110</span>

    <span class="k">if</span> <span class="n">tetalinha</span><span class="o">&gt;</span><span class="mi">180</span><span class="p">:</span>
        <span class="n">tetalinha</span>       <span class="o">=</span> <span class="mi">180</span>

    <span class="n">tetainterp</span>          <span class="o">=</span> <span class="n">tetalinha</span>
    <span class="c1"># logS</span>
    <span class="n">ai1</span>                 <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">logS</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iai1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ai1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">logS</span><span class="p">[</span><span class="n">iai1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">logStab</span><span class="p">):</span>
            <span class="n">logS</span><span class="p">[</span><span class="n">iai1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">logStab</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">logS</span><span class="p">[</span><span class="n">iai1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">logStab</span><span class="p">):</span>
            <span class="n">logS</span><span class="p">[</span><span class="n">iai1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">logStab</span><span class="p">)</span>


    <span class="c1"># cálculos</span>
    <span class="n">aux0</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">logS</span><span class="p">)</span>
    <span class="n">aux1</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">logS</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">aux2</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">aux0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    <span class="n">aux3</span>                <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aux1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">aux3</span><span class="o">==</span><span class="n">aux0</span> <span class="ow">and</span> <span class="n">aux2</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">SDL_f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp2d</span><span class="p">(</span><span class="n">tetatab</span><span class="p">,</span><span class="n">logStab</span><span class="p">,</span><span class="n">SDLtab</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
        <span class="n">SDL</span> <span class="o">=</span> <span class="n">SDL_f</span><span class="p">(</span><span class="n">tetainterp</span><span class="p">,</span><span class="n">logS</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SDL</span>             <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">logStab</span><span class="p">))</span>


    <span class="n">SPLcoaxial</span>          <span class="o">=</span> <span class="n">OASPL90plug</span><span class="o">*</span><span class="p">(</span><span class="n">plug</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">OASPL90circ</span><span class="o">*</span><span class="p">(</span><span class="n">plug</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">SDL</span><span class="o">-</span><span class="n">cdf</span> 
    <span class="n">SPLplug</span>             <span class="o">=</span> <span class="n">OASPL90plug</span><span class="o">+</span><span class="n">SDL</span><span class="o">-</span><span class="n">cdf</span>
    <span class="n">SPLcirc</span>             <span class="o">=</span> <span class="n">OASPL90circ</span><span class="o">+</span><span class="n">SDL</span><span class="o">-</span><span class="n">cdf</span>
    <span class="k">if</span> <span class="n">plug</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">SPLJet</span>          <span class="o">=</span> <span class="n">SPLcirc</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">coaxial</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">SPLJet</span>      <span class="o">=</span> <span class="n">SPLplug</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SPLJet</span>      <span class="o">=</span> <span class="n">SPLcoaxial</span><span class="o">.</span><span class="n">T</span>


    <span class="c1">## Atenuação do ruído na atmosfera ##</span>
    <span class="n">ft</span><span class="p">,</span> <span class="n">alfaamortt</span><span class="p">,</span> <span class="n">amorttott</span><span class="p">,</span> <span class="n">deltaLamort</span><span class="p">,</span> <span class="n">SPLrt</span> <span class="o">=</span> <span class="n">atmospheric_attenuation</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">noise_parameters</span><span class="p">,</span><span class="n">radialdistance</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>


    <span class="c1">## DADOS DE SAIDA ##</span>
    <span class="n">ruidoJato</span>           <span class="o">=</span> <span class="n">SPLJet</span><span class="o">-</span><span class="n">deltaLamort</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ft</span>                  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span>
    <span class="n">ruidoJatot</span>          <span class="o">=</span> <span class="n">ruidoJato</span><span class="o">.</span><span class="n">T</span>

    <span class="n">a1</span>                  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ruidoJatot</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ia1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ruidoJatot</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ruidoJatot</span><span class="p">[</span><span class="n">ia1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>


    <span class="n">ruidoJatot</span> <span class="o">=</span> <span class="n">ruidoJatot</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">ft</span><span class="p">,</span> <span class="n">ruidoJatot</span></div>
<span class="c1"># =============================================================================</span>
<span class="c1"># MAIN</span>
<span class="c1"># =============================================================================</span>

<span class="c1"># =============================================================================</span>
<span class="c1"># TEST</span>
<span class="c1"># =============================================================================</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, gitificial.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>